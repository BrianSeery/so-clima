<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create react app</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <style>
        #map {
            width: 350px;
            height: 300px;
        }
    </style>
</head>

<body>
    <div>
        <div className="containerp-4">
            <div className="row">
                <div className="col-md-6 mx-auto">
                    <div className='card card-body'>
                        <div className='form-group'><input type="text" id="autocomplete"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id='map'></div>
        <script
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB7-xPxXdnAk14Eto8ngIlq_vXsd44vNDQ&libraries=places">
        </script>
        <div>
            <script>
                class Localizacion {
                    constructor(callback) {
                        if (navigator.geolocation) {
                            navigator.geolocation.getCurrentPosition((position) => {
                                this.latitude = position.coords.latitude;
                                this.longitude = position.coords.longitude;
                                callback();
                            });
                        } else {
                            output.innerHTML = "<p> Tu navegador NO soporta geolocalizacion </p>";
                        }
                    }
                }
                var ubicacion = new Localizacion();
                console.log(ubicacion)
                google.maps.event.addDomListener(window, "load", function () {
                    const ubicacion = new Localizacion(() => {
                        const myLatLng = {
                            lat: ubicacion.latitude,
                            lng: ubicacion.longitude
                        }

                        const options = {
                            center: myLatLng,
                            zoom: 12
                        }
                        var map = document.getElementById('map');
                        const mapa = new google.maps.Map(map, options);
                        const marcador = new google.maps.Marker({
                            position: myLatLng,
                            map: mapa,
                        });

                        var ventanaInformacion = new google.maps.InfoWindow();
                        marcador.addListener('click', function () {
                            ventanaInformacion.open(mapa, marcador);
                        });
                        var autocomplete = document.getElementById('autocomplete');
                        const search = new google.maps.places.Autocomplete(autocomplete);
                        search.bindTo("bounds", mapa);
                        search.addListener('place_changed', function () {
                            ventanaInformacion.close();
                            marcador.setVisible(false);
                            var place = search.getPlace();
                            if (!place.geometry.viewport) {
                                window.alert("Error al mostrar el lugar");
                                return;
                            }
                            if (place.geometry.viewport) {
                                mapa.fitBounds(place.geometry.viewport);
                            } else {
                                mapa.setCenter(place.geometry.location);
                                mapa.setZoom(18);
                            }
                            marcador.setPosition(place.geometry.location);
                            marcador.setVisible(true);
                            var latitud = place.geometry.location.lat();
                            var longitud = place.geometry.location.lng();
                            console.log("Latitud: " + latitud);
                            console.log("Longitud: " + longitud);

                        });
                    });
                });
            </script>
            <div id="app"></div>
        </div>
    </div>
</body>

</html>